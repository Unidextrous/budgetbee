#:kivy 2.0

<DashboardScreen>:
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "BudgetBee Dashboard"
            font_size: 32
        Label:
            text: "Total Balance: $" + root.total_balance
            font_size: 24
        Button:
            text: "Accounts"
            on_release: app.root.current = "accounts"
        Button:
            text: "Categories"
            on_release: app.root.current = "categories"
        Button:
            text: "Transactions"
            on_release: app.root.current = "transactions"
        Button:
            text: "Budgets"
            on_release: app.root.current = "budgets"

<AccountsScreen>:
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "Accounts"
            font_size: 28
        ScrollView:
            GridLayout:
                id: accts_list
                cols: 1
                size_hint_y: None
        Button:
            text: "Add Account"
            on_release: app.root.current = "add_account"
        Button:
            text: "Back"
            on_release: app.root.current = "dashboard"

<AddAccountScreen>:
    BoxLayout:
        orientation: "vertical"
        TextInput:
            id: owner
            hint_text: "Account Owner"
        TextInput:
            id: name
            hint_text: "Account Name"
        TextInput:
            id: balance
            hint_text: "Balance"
            input_filter: "float"
        Button:
            text: "Save Account"
            on_release: root.add_account(owner.text, name.text, balance.text)
        Button:
            text: "Back"
            on_release: app.root.current = "accounts"

<EditAccountScreen>:
    BoxLayout:
        orientation: "vertical"
        TextInput:
            id: owner
            hint_text: "Account Owner"
        TextInput:
            id: name
            hint_text: "Account Name"
        TextInput:
            id: balance
            hint_text: "Balance"
            input_filter: "float"
        Button:
            text: "Save Account"
            on_release: root.save_account()
        Button:
            text: "Back"
            on_release: app.root.current = "accounts"
        
<CategoriesScreen>:
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "Categories"
            font_size: 28
        ScrollView:
            GridLayout:
                id: cats_list
                cols: 1
                size_hint_y: None
        Button:
            text: "Add Category"
            on_release: app.root.current = "add_category"
        Button:
            text: "Back"
            on_release: app.root.current = "dashboard"

<AddCategoryScreen>:
    BoxLayout:
        orientation: "vertical"
        TextInput:
            id: name
            hint_text: "Category Name"
        BoxLayout:
            orientation: "horizontal"
            ToggleButton:
                id: income_btn
                text: "Income"
                group: "type"
            ToggleButton:
                id: expense_btn
                text: "Expense"
                group: "type"
        Button:
            text: "Save Category"
            on_release: root.add_category(name.text, "Income" if income_btn.state == "down" else "Expense")
        Button:
            text: "Back"
            on_release: app.root.current = "categories"

<EditCategoryScreen>:
    BoxLayout:
        orientation: "vertical"
        TextInput:
            id: name
            hint_text: "Category Name"
        BoxLayout:
            orientation: "horizontal"
            ToggleButton:
                id: income_btn
                text: "Income"
                group: "type"
            ToggleButton:
                id: expense_btn
                text: "Expense"
                group: "type"
        Button:
            text: "Save Category"
            on_release: root.save_category()
        Button:
            text: "Back"
            on_release: app.root.current = "categories"

<TransactionsScreen>:
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "Transactions"
            font_size: 28
        ScrollView:
            GridLayout:
                id: txns_list
                cols: 1
                size_hint_y: None
        Button:
            text: "Add Transaction"
            on_release: app.root.current = "add_transaction"
        Button:
            text: "Back"
            on_release: app.root.current = "dashboard"

<AddTransactionScreen>:
    account_spinner: account_spinner
    category_spinner: category_spinner
    BoxLayout:
        orientation: "vertical"
        Spinner:
            id: account_spinner
            text: "Select Account"
            values: []
        Spinner:
            id: category_spinner
            text: "Select Category"
            values: []
        TextInput:
            id: amount
            hint_text: "Amount"
            input_filter: "float"
        TextInput:
            id: date
            hint_text: "Date (YYYY-MM-DD) (Default: Today)"
        TextInput:
            id: description
            hint_text: "Description"
        Button:
            text: "Save Transaction"
            on_release: root.add_transaction(account_spinner.text, category_spinner.text, amount.text, date.text, description.text)
        Button:
            text: "Back"
            on_release: app.root.current = "transactions"

<BudgetsScreen>:
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "Budgets"
            font_size: 28
        ScrollView:
            GridLayout:
                id: budgets_list
                cols: 1
                size_hint_y: None
        Button:
            text: "Add Budget"
            on_release: app.root.current = "add_budget"
        Button:
            text: "Back"
            on_release: app.root.current = "dashboard"

<AddBudgetScreen>:
    BoxLayout:
        orientation: "vertical"
        TextInput:
            id: budget_name
            hint_text: "Budget Name"
        TextInput:
            id: start_date
            hint_text: "Start Date (YYYY-MM-DD, optional)"
        Spinner:
            id: type_spinner
            text: "Paycheck"
            values: ["Paycheck", "Monthly", "Yearly"]
        Button:
            text: "Save Budget"
            on_release: root.add_budget(budget_name.text, start_date.text, type_spinner.text)
        Button:
            text: "Back"
            on_release: app.root.current = "budgets"

<BudgetSummaryScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: 10
        spacing: 10

        Label:
            text: "Budget Summary"
            font_size: 28

        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: 30
            spacing: 10
            Label:
                id: allocated_label
                text: ""
                size_hint_y: None
                height: 30
            Label:
                id: spent_label
                text: ""
                size_hint_y: None
                height: 30
            Label:
                id: projected_label
                text: ""
                size_hint_y: None
                height: 30
            Label:
                id: remaining_label
                text: ""
                size_hint_y: None
                height: 30

        # ------------------------------
        # Add Allocated Category Section
        # ------------------------------
        Label:
            text: "Add Allocated Category"
            font_size: 22
        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: 40
            spacing: 5
            Spinner:
                id: alloc_category_spinner
                text: "Select Category"
                values: []
            TextInput:
                id: alloc_amount
                hint_text: "Amount"
                input_filter: "float"
            Button:
                text: "Add"
                size_hint_x: None
                width: 80
                on_release: root.add_budgeted_category(alloc_category_spinner.text, alloc_amount.text)

        Label:
            text: "Allocated Categories"
            font_size: 22
        ScrollView:
            GridLayout:
                id: allocated_list
                cols: 1
                size_hint_y: None

        # ------------------------------
        # Add Projected Transaction Section
        # ------------------------------
        Label:
            text: "Add Projected Transaction"
            font_size: 22
        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: 40
            spacing: 5
            Spinner:
                id: proj_account_spinner
                text: "Select Account"
                values: []
            Spinner:
                id: proj_category_spinner
                text: "Select Category"
                values: []
            TextInput:
                id: proj_amount
                hint_text: "Amount"
                input_filter: "float"
            TextInput:
                id: proj_date
                hint_text: "Date (YYYY-MM-DD)"
            Button:
                text: "Add"
                size_hint_x: None
                width: 80
                on_release: root.add_projected_transaction(proj_account_spinner.text, proj_category_spinner.text, proj_amount.text, proj_date.text)

        Label:
            text: "Projected Transactions"
            font_size: 22
        ScrollView:
            GridLayout:
                id: projected_list
                cols: 1
                size_hint_y: None

        Button:
            text: "Back"
            size_hint_y: None
            height: 40
            on_release: app.root.current = "budgets"
